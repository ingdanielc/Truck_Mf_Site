<div class="mt-2">
  <div
    class="flex justify-content-between align-items-center flex-wrap mt-3 gap-2"
  >
    <g-title title="Control de Acceso" style="margin-top: -1rem"></g-title>
    <div class="flex flex-wrap gap-2">
      <p-button
        class="mr-3"
        label="Crear socio"
        borderRadius="10px"
        icon="ml-4 fa-solid fa-user-plus"
        (onClick)="btnCreateNewPartner()"
      >
      </p-button>
      <p-button
        label="Asociar membresía"
        borderRadius="10px"
        icon="ml-4 fa-solid fa-clipboard-check"
        (onClick)="btnSetMembership()"
      >
      </p-button>
    </div>
  </div>
  <div class="flex flex-column justify-content-center">
    <div class="flex w-full my-4 bg-white border-round-2xl pb-3 px-3 lg:px-8">
      <form class="flex mt-5 font-bold w-full" [formGroup]="accessForm">
        <div class="field w-full">
          <label for="identification">Identificación / Celular*</label>
          <p-inputNumber
            pInputNumber
            id="identification"
            [max]="999999999999999"
            [min]="-1"
            [maxFractionDigits]="0"
            placeholder="Escribe"
            class="w-full lg"
            [style]="{ width: '100%' }"
            [(ngModel)]="identification"
            formControlName="identification"
            [ngClass]="{
              'ng-invalid ng-dirty':
                isInvalid('identification') || partnerNoExist
            }"
            (onBlur)="validatePartner()"
            (onKeyDown)="partnerNoExist = false; manyPartners = false"
          ></p-inputNumber>

          <small
            *ngIf="isInvalid('identification')"
            class="p-error font-normal block"
            ><i class="pi pi-info-circle mr-2"></i>{{ errorText }}
          </small>
          <small *ngIf="partnerNoExist" class="p-error font-normal block"
            ><i class="pi pi-info-circle mr-2"></i>{{ errorNoExist }}
          </small>
          <small *ngIf="manyPartners" class="p-error font-normal block"
            ><i class="pi pi-info-circle mr-2"></i>{{ errorManyPartners }}
          </small>
        </div>
      </form>
    </div>
    <div class="flex flex-wrap justify-content-center">
      <div *ngFor="let setting of settings; let i = index">
        <div class="mx-2 line-height-1">
          <g-option-card
            class="mx-2 py-0 my-0"
            title="{{ setting.title }}"
            icon="{{ setting.icon }}"
            [today]="setting.today"
            [yesterday]="setting.yesterday"
            [link]="setting.link"
          ></g-option-card>
        </div>
      </div>
    </div>
  </div>
</div>

<g-card-set-membership
  [show]="showSetMembership"
  [goToPartners]="false"
  (showEmiter)="showSetMembership = $event"
></g-card-set-membership>

<g-card-partner-access
  [show]="showPartnerDetail"
  [partner]="partner"
  [accessValid]="accessValid"
  [lastAccess]="lastAccess"
  [partnerMembership]="partnerMembership"
  (showEmiter)="showPartnerDetail = $event"
></g-card-partner-access>
